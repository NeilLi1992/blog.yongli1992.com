title: LeetCode：唯一二叉搜索树的数量
id: 156
categories:
  - 未分类
date: 2015-02-22 07:26:40
tags:
---

<del style="position:relative;display:block">[Edit](http://maxiang.info/#/?provider=evernote_int&amp;guid=1a56c5f3-b43d-41c8-ab45-1f18c506c07a)</del><div  style="line-height: 1.5; color: #2c3f51; font-family: Helvetica Neue, Arial, Hiragino Sans GB, STHeiti, Microsoft YaHei, WenQuanYi Micro Hei, SimSun, Song, sans-serif;">
                        <div ></div>
                    <div >

`归档` `翻译` `python` `leetCodeOJ` `算法` `eat.wordpress.post` 
</div><div >

翻译一道在 LeetCode 上遇到的题目的解法。 

原题：

    给定 n，找到存储着 <span  style="color: #ae81ff;">1</span>, <span  style="color: #ae81ff;">2</span>, <span  style="color: #ae81ff;">3</span>,<span  style="color: #f92672;">...</span>, n 的不同结构的二叉搜索树的数量。
    如：给定 n=<span  style="color: #ae81ff;">3</span>，有 <span  style="color: #ae81ff;">5</span> 种不同的 BST：
     <span  style="color: #ae81ff;">1</span>         <span  style="color: #ae81ff;">3</span>     <span  style="color: #ae81ff;">3</span>      <span  style="color: #ae81ff;">2</span>      <span  style="color: #ae81ff;">1</span>
      \       /     /      / \      \
       <span  style="color: #ae81ff;">3</span>     <span  style="color: #ae81ff;">2</span>     <span  style="color: #ae81ff;">1</span>      <span  style="color: #ae81ff;">1</span>   <span  style="color: #ae81ff;">3</span>      <span  style="color: #ae81ff;">2</span>
      /     /       \                 \
     <span  style="color: #ae81ff;">2</span>     <span  style="color: #ae81ff;">1</span>         <span  style="color: #ae81ff;">2</span>                 <span  style="color: #ae81ff;">3</span>
    `</pre>

    原文地址：[LeetCode Discussion](https://oj.leetcode.com/discuss/24282/dp-solution-in-6-lines-with-explanation-f-i-n-g-i-1-g-n-i) 

    翻译：YongLi1992

    * * *

    <!--more--> 

    该问题可以用动态规划解决。

    给定数列 1…n，要从该数列构建 BST，我们可以枚举数列中的每一个数字 i，使用 i 来作为根节点，则数列中剩下的 1…(i-1) 位于左子树，(i+1)…n 位于右子树。然后就可以递归地构建左右子树。通过这一方法，我们可以确保构建地 BST 是唯一的，因为所有子树的根节点是唯一的。

    我们定义两个函数：

*   G(n)：从长度为 n 的数列构建的不同 BST 的数量。
*   F(i, n), i &lt;= i &lt;= n：以 i 作为根节点，从数列 1 到 n 构建的不同 BST 的数量。

    可见，G(n) 是真正要计算的函数。G(n) 可以从 F(i, n) 导出，而最终 F(i, n) 又可以递归地用 G(n) 来表示。

    我们可以看到，根据上面两个函数的定义，G(n) 就是使用每一个 i 作为根节点后 F(i) 的总和，即：

    <pre  style="font-family: Source Code Pro,monospace; font-size: .9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0 0 1.1em; line-height: 1.45; word-break: break-word; word-wrap: break-word; color: #333; background-color: rgba(102,128,153,0.05); border: 0; border-radius: 5px; text-align: start; background: #f6f6f6;">`G(n) = <span  style="color: #ae81ff;">F</span>(<span  style="color: #ae81ff;">1</span>, n) + <span  style="color: #ae81ff;">F</span>(<span  style="color: #ae81ff;">2</span>, n) + <span  style="color: #f92672;">...</span> + <span  style="color: #ae81ff;">F</span>(n, n)
    `</pre>

    而对于 G(n) 的基本解，是对于长度为 1 的数列只有一个 BST，对于长度为 0 的数列也只有一个 BST （空树）。

    <pre  style="font-family: Source Code Pro,monospace; font-size: .9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0 0 1.1em; line-height: 1.45; word-break: break-word; word-wrap: break-word; color: #333; background-color: rgba(102,128,153,0.05); border: 0; border-radius: 5px; text-align: start; background: #f6f6f6;">`<span  style="color: #f92672;"><span  style="color: #a6e22e;">G</span><span  style="color: #f8f8f2;">(<span  style="color: #ae81ff;">0</span>)</span></span> = <span  style="color: #ae81ff;">1</span>, <span  style="color: #f92672;"><span  style="color: #a6e22e;">G</span><span  style="color: #f8f8f2;">(<span  style="color: #ae81ff;">1</span>)</span></span> = <span  style="color: #ae81ff;">1</span>
    `</pre>

    给定数列 1…n，当选 i 为根节点时，唯一 BST 的数量 F(i, n) 即为左子树和右子树分别的唯一 BST 个数的乘积：

    <pre  style="font-family: Source Code Pro,monospace; font-size: .9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0 0 1.1em; line-height: 1.45; word-break: break-word; word-wrap: break-word; color: #333; background-color: rgba(102,128,153,0.05); border: 0; border-radius: 5px; text-align: start; background: #f6f6f6;">`<span  style="color: #ae81ff;">F</span>(i, <span  style="color: #f92672;">n</span>) = <span  style="color: #f92672;">G</span>(i-1) * <span  style="color: #f92672;">G</span>(<span  style="color: #f92672;">n</span>-i)  1 &lt;= i &lt;= <span  style="color: #f92672;">n</span>
    `</pre>

    综上所述，我们可以得到 G(n) 的递归表达式：

    <pre  style="font-family: Source Code Pro,monospace; font-size: .9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0 0 1.1em; line-height: 1.45; word-break: break-word; word-wrap: break-word; color: #333; background-color: rgba(102,128,153,0.05); border: 0; border-radius: 5px; text-align: start; background: #f6f6f6;">`<span  style="color: #f92672;">G</span>(<span  style="color: #f92672;">n</span>) = <span  style="color: #f92672;">G</span>(0) * <span  style="color: #f92672;">G</span>(<span  style="color: #f92672;">n</span>-1) + <span  style="color: #f92672;">G</span>(1) * <span  style="color: #f92672;">G</span>(<span  style="color: #f92672;">n</span>-2) + ... + <span  style="color: #f92672;">G</span>(<span  style="color: #f92672;">n</span>-1) * <span  style="color: #f92672;">G</span>(0)
    `</pre>

    下面是最终的 Python 代码：
    </div><div >

    <pre  style="font-family: Source Code Pro,monospace; font-size: .9em; white-space: pre-wrap; display: block; padding: 2px; margin: 0 0 1.1em; line-height: 1.45; word-break: break-word; word-wrap: break-word; color: #333; background-color: rgba(102,128,153,0.05); border: 0; border-radius: 5px; text-align: start; background: #f6f6f6;">`<span  style="color: #f92672;"><span  style="color: #66d9ef;">def</span> <span  style="color: #a6e22e;">numTrees</span><span  style="color: #f8f8f2;">(n)</span>:</span>
        G = [<span  style="color: #ae81ff;">1</span>, <span  style="color: #ae81ff;">1</span>]
        <span  style="color: #f92672;">for</span> i <span  style="color: #f92672;">in</span> xrange(<span  style="color: #ae81ff;">2</span>, n+<span  style="color: #ae81ff;">1</span>):
            G.append(<span  style="color: #ae81ff;">0</span>)
            <span  style="color: #f92672;">for</span> j <span  style="color: #f92672;">in</span> xrange(<span  style="color: #ae81ff;">1</span>, i+<span  style="color: #ae81ff;">1</span>):
                G[i] += G[j-<span  style="color: #ae81ff;">1</span>] * G[i-j]
        <span  style="color: #f92672;">return</span> G[n]
</div><div ></div></div><center style='display:none'>@%28%u5F52%u6863%29%5B%u7FFB%u8BD1%7Cpython%7CleetCodeOJ%7C%u7B97%u6CD5%7Ceat.wordpress.post%5D%0A%23%23%20LeetCode%uFF1A%u552F%u4E00%u4E8C%u53C9%u641C%u7D22%u6811%u7684%u6570%u91CF%0A%u7FFB%u8BD1%u4E00%u9053%u5728%20LeetCode%20%u4E0A%u9047%u5230%u7684%u9898%u76EE%u7684%u89E3%u6CD5%u3002%0A%u539F%u9898%uFF1A%0A%20%20%20%20%0A%20%20%20%20%u7ED9%u5B9A%20n%uFF0C%u627E%u5230%u5B58%u50A8%u7740%201%2C%202%2C%203%2C...%2C%20n%20%u7684%u4E0D%u540C%u7ED3%u6784%u7684%u4E8C%u53C9%u641C%u7D22%u6811%u7684%u6570%u91CF%u3002%0A%20%20%20%20%u5982%uFF1A%u7ED9%u5B9A%20n%3D3%uFF0C%u6709%205%20%u79CD%u4E0D%u540C%u7684%20BST%uFF1A%0A%20%20%20%20%201%20%20%20%20%20%20%20%20%203%20%20%20%20%203%20%20%20%20%20%202%20%20%20%20%20%201%0A%20%20%20%20%20%20%5C%20%20%20%20%20%20%20/%20%20%20%20%20/%20%20%20%20%20%20/%20%5C%20%20%20%20%20%20%5C%0A%20%20%20%20%20%20%203%20%20%20%20%202%20%20%20%20%201%20%20%20%20%20%201%20%20%203%20%20%20%20%20%202%0A%20%20%20%20%20%20/%20%20%20%20%20/%20%20%20%20%20%20%20%5C%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%5C%0A%20%20%20%20%202%20%20%20%20%201%20%20%20%20%20%20%20%20%202%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%203%0A%u539F%u6587%u5730%u5740%uFF1A%5BLeetCode%20Discussion%5D%28https%3A//oj.leetcode.com/discuss/24282/dp-solution-in-6-lines-with-explanation-f-i-n-g-i-1-g-n-i%29%0A%u7FFB%u8BD1%uFF1AYongLi1992%0A***%0A%3C%21--more--%3E%0A%u8BE5%u95EE%u9898%u53EF%u4EE5%u7528%u52A8%u6001%u89C4%u5212%u89E3%u51B3%u3002%0A%0A%u7ED9%u5B9A%u6570%u5217%201...n%uFF0C%u8981%u4ECE%u8BE5%u6570%u5217%u6784%u5EFA%20BST%uFF0C%u6211%u4EEC%u53EF%u4EE5%u679A%u4E3E%u6570%u5217%u4E2D%u7684%u6BCF%u4E00%u4E2A%u6570%u5B57%20i%uFF0C%u4F7F%u7528%20i%20%u6765%u4F5C%u4E3A%u6839%u8282%u70B9%uFF0C%u5219%u6570%u5217%u4E2D%u5269%u4E0B%u7684%201...%28i-1%29%20%u4F4D%u4E8E%u5DE6%u5B50%u6811%uFF0C%28i+1%29...n%20%u4F4D%u4E8E%u53F3%u5B50%u6811%u3002%u7136%u540E%u5C31%u53EF%u4EE5%u9012%u5F52%u5730%u6784%u5EFA%u5DE6%u53F3%u5B50%u6811%u3002%u901A%u8FC7%u8FD9%u4E00%u65B9%u6CD5%uFF0C%u6211%u4EEC%u53EF%u4EE5%u786E%u4FDD%u6784%u5EFA%u5730%20BST%20%u662F%u552F%u4E00%u7684%uFF0C%u56E0%u4E3A%u6240%u6709%u5B50%u6811%u7684%u6839%u8282%u70B9%u662F%u552F%u4E00%u7684%u3002%0A%0A%u6211%u4EEC%u5B9A%u4E49%u4E24%u4E2A%u51FD%u6570%uFF1A%0A%0A-%20G%28n%29%uFF1A%u4ECE%u957F%u5EA6%u4E3A%20n%20%u7684%u6570%u5217%u6784%u5EFA%u7684%u4E0D%u540C%20BST%20%u7684%u6570%u91CF%u3002%0A-%20F%28i%2C%20n%29%2C%20i%20%3C%3D%20i%20%3C%3D%20n%uFF1A%u4EE5%20i%20%u4F5C%u4E3A%u6839%u8282%u70B9%uFF0C%u4ECE%u6570%u5217%201%20%u5230%20n%20%u6784%u5EFA%u7684%u4E0D%u540C%20BST%20%u7684%u6570%u91CF%u3002%0A%0A%u53EF%u89C1%uFF0CG%28n%29%20%u662F%u771F%u6B63%u8981%u8BA1%u7B97%u7684%u51FD%u6570%u3002G%28n%29%20%u53EF%u4EE5%u4ECE%20F%28i%2C%20n%29%20%u5BFC%u51FA%uFF0C%u800C%u6700%u7EC8%20F%28i%2C%20n%29%20%u53C8%u53EF%u4EE5%u9012%u5F52%u5730%u7528%20G%28n%29%20%u6765%u8868%u793A%u3002%0A%0A%u6211%u4EEC%u53EF%u4EE5%u770B%u5230%uFF0C%u6839%u636E%u4E0A%u9762%u4E24%u4E2A%u51FD%u6570%u7684%u5B9A%u4E49%uFF0CG%28n%29%20%u5C31%u662F%u4F7F%u7528%u6BCF%u4E00%u4E2A%20i%20%u4F5C%u4E3A%u6839%u8282%u70B9%u540E%20F%28i%29%20%u7684%u603B%u548C%uFF0C%u5373%uFF1A%0A%0A%20%20%20%20G%28n%29%20%3D%20F%281%2C%20n%29%20+%20F%282%2C%20n%29%20+%20...%20+%20F%28n%2C%20n%29%0A%u800C%u5BF9%u4E8E%20G%28n%29%20%u7684%u57FA%u672C%u89E3%uFF0C%u662F%u5BF9%u4E8E%u957F%u5EA6%u4E3A%201%20%u7684%u6570%u5217%u53EA%u6709%u4E00%u4E2A%20BST%uFF0C%u5BF9%u4E8E%u957F%u5EA6%u4E3A%200%20%u7684%u6570%u5217%u4E5F%u53EA%u6709%u4E00%u4E2A%20BST%20%uFF08%u7A7A%u6811%uFF09%u3002%0A%0A%20%20%20%20G%280%29%20%3D%201%2C%20G%281%29%20%3D%201%0A%u7ED9%u5B9A%u6570%u5217%201...n%uFF0C%u5F53%u9009%20i%20%u4E3A%u6839%u8282%u70B9%u65F6%uFF0C%u552F%u4E00%20BST%20%u7684%u6570%u91CF%20F%28i%2C%20n%29%20%u5373%u4E3A%u5DE6%u5B50%u6811%u548C%u53F3%u5B50%u6811%u5206%u522B%u7684%u552F%u4E00%20BST%20%u4E2A%u6570%u7684%u4E58%u79EF%uFF1A%0A%20%20%20%20%20%0A%20%20%20%20F%28i%2C%20n%29%20%3D%20G%28i-1%29%20*%20G%28n-i%29%20%201%20%3C%3D%20i%20%3C%3D%20n%0A%u7EFC%u4E0A%u6240%u8FF0%uFF0C%u6211%u4EEC%u53EF%u4EE5%u5F97%u5230%20G%28n%29%20%u7684%u9012%u5F52%u8868%u8FBE%u5F0F%uFF1A%0A%0A%20%20%20%20G%28n%29%20%3D%20G%280%29%20*%20G%28n-1%29%20+%20G%281%29%20*%20G%28n-2%29%20+%20...%20+%20G%28n-1%29%20*%20G%280%29%0A%u4E0B%u9762%u662F%u6700%u7EC8%u7684%20Python%20%u4EE3%u7801%uFF1A%0A%60%60%60python%0Adef%20numTrees%28n%29%3A%0A%09G%20%3D%20%5B1%2C%201%5D%0A%09for%20i%20in%20xrange%282%2C%20n+1%29%3A%0A%09%09G.append%280%29%0A%09%09for%20j%20in%20xrange%281%2C%20i+1%29%3A%0A%09%09%09G%5Bi%5D%20+%3D%20G%5Bj-1%5D%20*%20G%5Bi-j%5D%0A%09return%20G%5Bn%5D%0A%60%60%60</center>