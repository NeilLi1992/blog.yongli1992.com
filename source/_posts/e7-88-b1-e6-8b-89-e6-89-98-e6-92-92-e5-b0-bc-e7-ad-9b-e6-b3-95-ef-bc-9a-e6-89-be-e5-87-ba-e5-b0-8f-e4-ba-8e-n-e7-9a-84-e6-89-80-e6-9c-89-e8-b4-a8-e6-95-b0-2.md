title: 爱拉托撒尼筛法：找出小于 n 的所有质数
id: 168
categories:
  - 未分类
date: 2015-04-28 07:10:49
tags:
---

以内的质数 p1, p2, p3 … pk。先用 2 去筛选，即把 2 留下，把 2 的倍数全部剔除；再用下一个质数 3 去筛选，再用 5， 7… 不断重复。

实际实现的时候，在用 pk 去筛选的时候，实际上只要从 <span style="word-wrap: normal; vertical-align: middle; font-style: normal; font-weight: normal; line-height: normal; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; margin: 0; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; display: inline-block; font-size: 100%;">![](http://yongli1992.com/wp-content/uploads/2015/04/14302014461.png)</span> 开始筛选即可，因为小于 的已经被 pk 之前的其他质数给筛掉了。

在 LeetCode 上有一题类似的，但是问的是小于 n 的所有质数的个数，也可以用这个办法来求。

原题链接：[Count Primes](https://leetcode.com/problems/count-primes/)

Python代码如下：

<!--more-->
<div>

    <span style="color: #66d9ef;">class</span> <span style="color: #a6e22e; font-style: italic;">Solution</span>:
        <span style="color: #75715e;"># @param {integer}</span>
        <span style="color: #75715e;"># @return {integer}</span>
        <span style="color: #f92672;"><span style="color: #66d9ef;">def</span> <span style="color: #a6e22e;">countPrimes</span><span style="color: #f8f8f2;">(self, n)</span>:</span>
            <span style="color: #f92672;">if</span> n &lt; <span style="color: #ae81ff;">2</span>:
                <span style="color: #f92672;">return</span> <span style="color: #ae81ff;">0</span>

            isPrime = [<span style="color: #f92672;">True</span> <span style="color: #f92672;">for</span> i <span style="color: #f92672;">in</span> xrange(n)]
            isPrime[<span style="color: #ae81ff;">0</span>] = isPrime[<span style="color: #ae81ff;">1</span>] = <span style="color: #f92672;">False</span>

            <span style="color: #75715e;"># Test all Primes less than sqrt(n)</span>
            i = <span style="color: #ae81ff;">2</span>
            <span style="color: #f92672;">while</span> i ** <span style="color: #ae81ff;">2</span> &lt; n:
                <span style="color: #f92672;">if</span> isPrime[i]:
                    multiplier = <span style="color: #ae81ff;">0</span>
                    <span style="color: #f92672;">while</span> i ** <span style="color: #ae81ff;">2</span> + i * multiplier &lt; n:
                        isPrime[i ** <span style="color: #ae81ff;">2</span> + i * multiplier] = <span style="color: #f92672;">False</span>
                        multiplier += <span style="color: #ae81ff;">1</span>
                i += <span style="color: #ae81ff;">1</span>

            <span style="color: #f92672;">return</span> sum(isPrime)

</div>
<div></div>
<center style="display: none;">@%28%u5F52%u6863%29%5B%u7B97%u6CD5%7CleetCodeOJ%7Ceat.wordpress.post%5D%0A%23%20%u7231%u62C9%u6258%u6492%u5C3C%u7B5B%u6CD5%uFF1A%u627E%u51FA%u5C0F%u4E8E%20n%20%u7684%u6240%u6709%u8D28%u6570%0A%0ASieve%20of%20Eratostheness%uFF0C%u7231%u62C9%u6258%u6492%u5C3C%u7B5B%u6CD5%uFF0C%u662F%u4E00%u79CD%u53EF%u4EE5%u5FEB%u901F%u627E%u51FA%u5C0F%u4E8E%20n%20%u7684%u6240%u6709%u8D28%u6570%u7684%u7B97%u6CD5%u3002%u5176%u57FA%u672C%u601D%u60F3%u662F%uFF1A%0A%0A%3E%20%u7ED9%u51FA%u8981%u7B5B%u9009%u6570%u503C%u7684%u8303%u56F4%20n%uFF0C%u627E%u51FA%24%5Csqrt%7Bn%7D%24%u4EE5%u5185%u7684%u8D28%u6570%20p1%2C%20p2%2C%20p3%20...%20pk%u3002%u5148%u7528%202%20%u53BB%u7B5B%u9009%uFF0C%u5373%u628A%202%20%u7559%u4E0B%uFF0C%u628A%202%20%u7684%u500D%u6570%u5168%u90E8%u5254%u9664%uFF1B%u518D%u7528%u4E0B%u4E00%u4E2A%u8D28%u6570%203%20%u53BB%u7B5B%u9009%uFF0C%u518D%u7528%205%uFF0C%207...%20%u4E0D%u65AD%u91CD%u590D%u3002%0A%0A%u5B9E%u9645%u5B9E%u73B0%u7684%u65F6%u5019%uFF0C%u5728%u7528%20pk%20%u53BB%u7B5B%u9009%u7684%u65F6%u5019%uFF0C%u5B9E%u9645%u4E0A%u53EA%u8981%u4ECE%20%24pk%5E2%24%20%u5F00%u59CB%u7B5B%u9009%u5373%u53EF%uFF0C%u56E0%u4E3A%u5C0F%u4E8E%20%24%20pk%5E2%20%24%20%u7684%u5DF2%u7ECF%u88AB%20pk%20%u4E4B%u524D%u7684%u5176%u4ED6%u8D28%u6570%u7ED9%u7B5B%u6389%u4E86%u3002%0A%0A%u5728%20LeetCode%20%u4E0A%u6709%u4E00%u9898%u7C7B%u4F3C%u7684%uFF0C%u4F46%u662F%u95EE%u7684%u662F%u5C0F%u4E8E%20n%20%u7684%u6240%u6709%u8D28%u6570%u7684%u4E2A%u6570%uFF0C%u4E5F%u53EF%u4EE5%u7528%u8FD9%u4E2A%u529E%u6CD5%u6765%u6C42%u3002%0A%u539F%u9898%u94FE%u63A5%uFF1A%5BCount%20Primes%5D%28https%3A//leetcode.com/problems/count-primes/%29%0A%0APython%u4EE3%u7801%u5982%u4E0B%uFF1A%0A%60%60%60python%0Aclass%20Solution%3A%0A%20%20%20%20%23%20@param%20%7Binteger%7D%0A%20%20%20%20%23%20@return%20%7Binteger%7D%0A%20%20%20%20def%20countPrimes%28self%2C%20n%29%3A%0A%20%20%20%20%20%20%20%20if%20n%20%3C%202%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20return%200%0A%0A%20%20%20%20%20%20%20%20isPrime%20%3D%20%5BTrue%20for%20i%20in%20xrange%28n%29%5D%0A%20%20%20%20%20%20%20%20isPrime%5B0%5D%20%3D%20isPrime%5B1%5D%20%3D%20False%0A%20%20%20%20%20%20%20%20%0A%20%20%20%20%20%20%20%20%23%20Test%20all%20Primes%20less%20than%20sqrt%28n%29%0A%20%20%20%20%20%20%20%20i%20%3D%202%0A%20%20%20%20%20%20%20%20while%20i%20**%202%20%3C%20n%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20if%20isPrime%5Bi%5D%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20multiplier%20%3D%200%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20while%20i%20**%202%20+%20i%20*%20multiplier%20%3C%20n%3A%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20isPrime%5Bi%20**%202%20+%20i%20*%20multiplier%5D%20%3D%20False%0A%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20%20multiplier%20+%3D%201%0A%20%20%20%20%20%20%20%20%20%20%20%20i%20+%3D%201%0A%0A%20%20%20%20%20%20%20%20return%20sum%28isPrime%29%0A%60%60%60</center>